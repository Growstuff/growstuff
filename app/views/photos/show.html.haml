- content_for :title, @photo.title
- content_for :opengraph do
  = tag("meta", property: "og:title", content: @photo.title)
  = tag("meta", property: "og:image", content: @photo.fullsize_url)
  = tag("meta", property: "og:image:user_generated", content: "true")
  = tag("meta", property: "og:type", content: "website")
  = tag("meta", property: "og:url", content: request.original_url)
  = tag("meta", property: "og:site_name", content: ENV['GROWSTUFF_SITE_NAME'])

.row
  .col-md-8
    %p= image_tag(@photo.fullsize_url, alt: @photo.title, class: 'img')

  .col-md-4
    %p
      - if can? :destroy, @photo
        = link_to @photo, method: :delete,
          data: { confirm: 'Are you sure?' }, class: 'btn btn-default btn-xs' do
          %span.glyphicon.glyphicon-trash{ title: "Delete" }

      - if can? :edit, @photo
        = link_to edit_photo_path(@photo), class: 'btn btn-default btn-xs' do
          %span.glyphicon.glyphicon-pencil{ title: "Edit" }
    %p
      %strong Posted by:
      = link_to @photo.owner, @photo.owner
    %p
      %strong License:
      - if @photo.license_url
        = link_to @photo.license_name, @photo.license_url
      - else
        = succeed "." do
          = @photo.license_name

    %p= link_to "View on Flickr", @photo.link_url

    - if @photo.associations?
      %h4 This photo depicts:
      %ul
        - @photo.plantings.each do |p|
          %li
            = link_to t('.planting', planting: p.to_s, owner: p.owner.to_s), planting_path(p)
            - if can? :edit, @photo
              = link_to photo_associations_path(photo_id: @photo.id,
                type: 'planting', planting_id: p.id), method: 'delete',
                class: 'btn btn-default btn-xs' do
                %span.glyphicon.glyphicon-remove{ title: "Remove link" }

        - @photo.harvests.each do |h|
          %li= link_to t('.harvest', crop: h.crop.name, owner: h.owner.to_s), harvest_path(h)

        - @photo.gardens.each do |g|
          %li= link_to t('.garden', garden: g.to_s, owner: g.owner.to_s), garden_path(g)

        - @photo.seeds.each do |s|
          %li= link_to t('.seed', seed: s.to_s, owner: s.owner.to_s), seed_path(s)
